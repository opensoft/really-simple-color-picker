/**
 * Really Simple Color Picker in jQuery
 * 
 * Licensed under the MIT (MIT-LICENSE.txt) licenses.
 *
 * Copyright (c) 2008-2012 
 * Lakshan Perera (www.laktek.com) & Daniel Lacy (daniellacy.com)
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to
 * deal in the Software without restriction, including without limitation the
 * rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
 * sell copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR 
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 * FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
 * IN THE SOFTWARE.
 */
(function(e){var a,d,c=0,b={control:e('<div class="colorPicker-picker">&nbsp;</div>'),palette:e('<div id="colorPicker_palette" class="colorPicker-palette" />'),swatch:e('<div class="colorPicker-swatch">&nbsp;</div>'),tSwatch:e('<div class="colorPicker-swatch">&nbsp;</div>'),hexLabel:e('<label for="colorPicker_hex">Hex</label>'),hexField:e('<input type="text" id="colorPicker_hex" />')},g="transparent",f;e.fn.colorPicker=function(h){return this.each(function(){var m=e(this),i=e.extend({},e.fn.colorPicker.defaults,h),k=e.fn.colorPicker.toHex((m.val().length>0)?m.val():i.pickerDefault),q=b.control.clone(),l=b.palette.clone().attr("id","colorPicker_palette-"+c),p=b.hexLabel.clone(),n=b.hexField.clone(),o=l[0].id,r,j;e.each(i.colors,function(s){r=b.swatch.clone();if(i.colors[s]===g){r.addClass(g).text("X");e.fn.colorPicker.bindPalette(n,r,g)}else{r.css("background-color","#"+this);e.fn.colorPicker.bindPalette(n,r)}r.appendTo(l)});if(h&&h.extraColors){r.after('<div style="margin-bottom:5px;">&nbsp;</div><div style="text-decoration:underline;">Template Colors</div>');e.each(h.extraColors,function(s){j=b.tSwatch.clone();if(h.extraColors[s]===g){j.addClass(g).text("X");e.fn.colorPicker.bindPalette(n,j,g)}else{j.css("background-color","#"+this);e.fn.colorPicker.bindPalette(n,j)}j.appendTo(l)})}p.attr("for","colorPicker_hex-"+c);n.attr({id:"colorPicker_hex-"+c,value:k});n.bind("keydown",function(t){if(t.keyCode===13){var s=e.fn.colorPicker.toHex(e(this).val());e.fn.colorPicker.changeColor(s?s:m.val())}if(t.keyCode===27){e.fn.colorPicker.hidePalette()}});n.bind("keyup",function(t){var s=e.fn.colorPicker.toHex(e(t.target).val());e.fn.colorPicker.previewColor(s?s:m.val())});e('<div class="colorPicker_hexWrap" />').append(p).appendTo(l);l.find(".colorPicker_hexWrap").append(n);e("body").append(l);l.hide();q.css("background-color",k);q.bind("click",function(){e.fn.colorPicker.togglePalette(e("#"+o),e(this))});if(h&&h.onColorChange){q.data("onColorChange",h.onColorChange)}else{q.data("onColorChange",function(){})}m.after(q);m.bind("change",function(){m.next(".colorPicker-picker").css("background-color",e.fn.colorPicker.toHex(e(this).val()))});m.val(k).hide();c++})};e.extend(true,e.fn.colorPicker,{toHex:function(i){if(i.match(/[0-9A-F]{6}|[0-9A-F]{3}$/i)){return(i.charAt(0)==="#")?i:("#"+i)}else{if(i.match(/^rgb\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*\)$/)){var m=([parseInt(RegExp.$1,10),parseInt(RegExp.$2,10),parseInt(RegExp.$3,10)]),l=function(p){if(p.length<2){for(var o=0,n=2-p.length;o<n;o++){p="0"+p}}return p};if(m.length===3){var k=l(m[0].toString(16)),j=l(m[1].toString(16)),h=l(m[2].toString(16));return"#"+k+j+h}}else{return false}}},checkMouse:function(j,i){var h=d,k=e(j.target).parents("#"+h.attr("id")).length;if(j.target===e(h)[0]||j.target===a[0]||k>0){return}e.fn.colorPicker.hidePalette()},hidePalette:function(){e(document).unbind("mousedown",e.fn.colorPicker.checkMouse);e(".colorPicker-palette").hide()},showPalette:function(h){var i=a.prev("input").val();h.css({top:a.offset().top+(a.outerHeight()),left:a.offset().left});e("#color_value").val(i);h.show();e(document).bind("mousedown",e.fn.colorPicker.checkMouse)},togglePalette:function(h,i){if(i){a=i}d=h;if(d.is(":visible")){e.fn.colorPicker.hidePalette()}else{e.fn.colorPicker.showPalette(h)}},changeColor:function(h){a.css("background-color",h);a.prev("input").val(h).change();e.fn.colorPicker.hidePalette();a.data("onColorChange").call(a,e(a).prev("input").attr("id"),h)},previewColor:function(h){a.css("background-color",h)},bindPalette:function(j,i,h){h=h?h:e.fn.colorPicker.toHex(i.css("background-color"));i.bind({click:function(k){f=h;e.fn.colorPicker.changeColor(h)},mouseover:function(k){f=j.val();e(this).css("border-color","#598FEF");j.val(h);e.fn.colorPicker.previewColor(h)},mouseout:function(k){e(this).css("border-color","#000");j.val(a.css("background-color"));j.val(f);e.fn.colorPicker.previewColor(f)}})}});e.fn.colorPicker.defaults={pickerDefault:"FFFFFF",colors:["ee2329","e95e62","e78285","e79fa1","ebbcbd","d0a5d3","b675ba","8d2893","75247a","304ca8","4f67b8","8495ce","0667b9","4b92ce","91bee5","14bab4","0d7f3d","3ab16c","a3d6b8","91c56b","e4ea34","e5e88b","edefae","e3973d","e8ae6a","ecc79c","573104","5e4e3a","7b6b59","000011","505051","89898b","c8c8ca","ffffff","d9d0bc","c3a053"],addColors:[]}})(jQuery);
